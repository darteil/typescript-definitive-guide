<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><script async="" type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/be7e0732075170e4249d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be7e0732075170e4249d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-0e3c274fd8419109d37b.js" defer=""></script><script src="/_next/static/chunks/framework-2f612445bd50b211f15a.js" defer=""></script><script src="/_next/static/chunks/main-bae6c3d363e548fddd65.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7389b94ba72d4b11a409.js" defer=""></script><script src="/_next/static/chunks/698-debec62034f2b0a49149.js" defer=""></script><script src="/_next/static/chunks/950-89b787edb52e4b1eb040.js" defer=""></script><script src="/_next/static/chunks/222-403d02ae2b812f34e8e4.js" defer=""></script><script src="/_next/static/chunks/460-d0b4dd1b0673465da22c.js" defer=""></script><script src="/_next/static/chunks/763-b007244d3307e1e9232d.js" defer=""></script><script src="/_next/static/chunks/211-767912ba0b0950a1ff12.js" defer=""></script><script src="/_next/static/chunks/803-3a52e0ed898ec3d6f5af.js" defer=""></script><script src="/_next/static/chunks/pages/book/chapters/%5BchapterId%5D-c88c0524de3ed6b9e5be.js" defer=""></script><script src="/_next/static/1XVAPM7hhG7WH3KTrWExV/_buildManifest.js" defer=""></script><script src="/_next/static/1XVAPM7hhG7WH3KTrWExV/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="base-layout"><div></div><header class="app-header app-header-grid"><div class="app-header-grid-item__driver-toggle"><button class="app-driver-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"></path></svg></button></div><div class="app-header-grid-item__logo"><span role="img" tabindex="-1" class="anticon app-logo"><svg id="logo_app_svg__Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 119.45 44" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><defs><style>.logo_app_svg__cls-2{fill:#1d1d1b}</style></defs><g id="logo_app_svg__logo"><path id="logo_app_svg__logo_t" d="M38.41 3v8.11H25.67v34.1h-9.5V11.08H3.43V3z" transform="translate(-3.43 -2)" fill="#3273b9"></path><path id="logo_app_svg__logo_g" class="logo_app_svg__cls-2" d="M63.7 10.29q-6.63 0-9.6 3.69c-2 2.45-3 5.82-3 10.08a20.23 20.23 0 00.73 5.64 12.6 12.6 0 002.19 4.36 10 10 0 003.66 2.83 12.18 12.18 0 005.12 1c1.06 0 2 0 2.71-.07a13.08 13.08 0 002-.24V22.9h9.51v20.91a37.27 37.27 0 01-5.48 1.43 48.07 48.07 0 01-9.33.76 24.32 24.32 0 01-8.62-1.46A18.13 18.13 0 0147 40.27a19 19 0 01-4.23-6.89 26.92 26.92 0 01-1.49-9.32 25 25 0 011.64-9.39 20.25 20.25 0 014.51-6.91 19.11 19.11 0 016.74-4.3A23.25 23.25 0 0162.42 2a34 34 0 015.4.39 34.4 34.4 0 014.18.92 18.52 18.52 0 012.87 1.07 18 18 0 011.61.85l-2.78 7.62a24.88 24.88 0 00-4.48-1.8 19 19 0 00-5.52-.76z" transform="translate(-3.43 -2)"></path><path id="logo_app_svg__logo_d" class="logo_app_svg__cls-2" d="M122.88 24.06a24.63 24.63 0 01-1.71 9.57 17.6 17.6 0 01-4.84 6.76 20.69 20.69 0 01-7.65 4 35.63 35.63 0 01-10.12 1.34q-2.55 0-6-.22a48 48 0 01-6.7-.88V3.52a56.55 56.55 0 016.85-.82q3.57-.21 6.13-.21a36.72 36.72 0 019.84 1.22 20.22 20.22 0 017.59 3.83 17.06 17.06 0 014.87 6.71 25.33 25.33 0 011.74 9.81zM95.39 37.47q.67.06 1.56.09t2.1 0q7.13 0 10.57-3.59t3.45-9.94q0-6.64-3.29-10.06t-10.43-3.38h-2a16.72 16.72 0 00-2 .16z" transform="translate(-3.43 -2)"></path></g></svg></span></div><div class="app-header-grid-item__search"><form class="search" autoComplete="off" action="#"><button class="search__submit-button-placeholder button-with-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon search__search-svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></button><input type="search" class="search__query-input" id="algolia-search" name="app-search-query" placeholder="search..." required=""/></form></div><div class="app-header-grid-item__secondary-bar"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="app-header-grid-item__primary-bar"><div class="dropdown app-nav__dropdown"><button class="dropdown__toggle app-nav__dropdown-toggle_adaptive"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button><div class="dropdown__menu app-nav__dropdown-menu_adaptive"><div class="flat-panel"><div class="app-nav__link-bar app-nav__link-bar_adaptive"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="divide-full_x app-nav__divide_adaptive"></div><div class="app-nav__nav"><nav class="app-nav"><ul class="menu app-nav__menu_adaptive"><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/">Главная</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/book/chapters">Оглавление</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/what-is-new">Что нового?</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/pdf">Скачать Pdf</a></li></ul></nav></div></div></div></div></div></header><div class="layer slide-layer" toggle="false"><div class="slide-layer__driver"><div class="slide-layer__fixed-driver"><div class="driver"><div class="layer driver-content-nav"><ul class="ant-menu ant-menu-root ant-menu-inline ant-menu-light driver-content-nav__menu" role="menu" tabindex="0" data-menu-list="true"> /// TODO: [refactoring]<li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">Содержание</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/HOC_(Higher-Order_Components)#Opredelenie_hoc">Определение hoc</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/HOC_(Higher-Order_Components)#Opredelenie_hoc_na_osnove_funkcionalnogo_komponenta">Определение hoc на основе функционального компонента</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/HOC_(Higher-Order_Components)#Opredelenie_hoc_na_osnove_klassovogo_komponenta">Определение hoc на основе классового компонента</a></span></li></ul></li></ul><div style="display:none" aria-hidden="true"> /// TODO: [refactoring]</div></div></div></div></div><div class="slide-layer__first-empty"></div><div class="slide-layer__content"><div class="content-box"><div class="content-box__page-nav content-box__page-nav_left"><div class="page-nav__bar page-nav__bar_left"><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn"><span role="img" aria-label="left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></span></button></div></div><main id="content" class="content-box__html"><aside><div class="github-file-info-bar"><div class="github-file-info-bar__section github-file-info-bar__section_contributors"><span class="github-file-info-bar__label">Контрибьютеры</span><div class="ant-avatar-group"><a href="https://github.com/nauchikus" target="_blank" class="ant-btn ant-btn-circle github-file-info-bar__avatar-btn"><span class="ant-avatar ant-avatar-circle ant-avatar-image"><img src="https://avatars.githubusercontent.com/u/31518738?v=4"/></span></a></div></div><div class="github-file-info-bar__section github-file-info-bar__section_update-info"><span class="github-file-info-bar__label">Обновлено</span><span class="github-file-info-bar__label_date">4/6/2021</span></div></div></aside><section id="HOC_(Higher-Order_Components)" class="content__section"><h1 class="content__heading">HOC (Higher-Order Components)</h1>
<p>Настало время рассмотреть со всех сторон механизм предназначенный для расширения функциональных возможностей компонента с помощью компонента-обертки обозначаемого как <em>Higher-Order Components</em> или сокращенно <em>HOC</em>.</p></section><section id="Opredelenie_hoc" class="content__section"><h2 class="content__heading">Определение hoc</h2>
<p>Раньше, при разработке <em>React</em> приложений разработчикам часто приходилось создавать конструкцию, известную в <em>react</em> сообществе, как <em>HOC</em> (<em>Higher-Order Components</em>).</p>
<p><em>HOC</em> — это функция, которая на входе принимает один компонент, а на выходе возвращает новый с более расширенным функционалом. Другими словами, <em>hoc</em> — это функция, ожидающая в качестве параметров компонент (назовем его входным), который оборачивается в другой, объявленный в теле функции, компонент, выступающий в роли возвращаемого из функции значения (назовем его выходным). Слово “оборачивание”, применимое относительно компонентов, означает, что один компонент отрисовывает (рендерит) другой компонент, со всеми вытекающими из этого процесса (проксирования). За счет того, что входной компонент оборачивается в выходной, достигается расширение его и/или общего функционала. Кроме того, это позволяет устанавливать входному компоненту как зависимости, так и данные, полученные из внешних сервисов.</p></section><section id="Opredelenie_hoc_na_osnove_funkcionalnogo_komponenta" class="content__section"><h2 class="content__heading">Определение hoc на основе функционального компонента</h2>
<p>В качестве примера реализуем сценарий при котором пропсы <em>компонента обертки</em> определяемого в теле <em>hoc</em> разделяются на две категории. Первая необходима исключительно самому компоненту-обертке для генерации новых пропсов, которые в дальнейшем будут объединены с пропсами относящихся ко второй категории и установлены <em>оборачиваемому компоненту</em>.</p>
<p>Начать стоит с детального рассмотрения сигнатуры универсальной функции, ожидающей в качестве единственного параметра типа тип <code class="content__code_inline">WrappedProps</code> представляющий пропсы предназначенные исключительно оборачиваемому-компоненту ссылка на который доступна через единственный параметр <code class="content__code_inline">WrappedComponent</code>. <code class="content__code_inline">WrappedComponent</code> может принадлежать, как к функциональному <code class="content__code_inline">FC&lt;T&gt;</code>, так и классовому типу <code class="content__code_inline">ComponentClass&lt;T&gt;</code>, поэтому указываем ему в аннотации обобщенный тип <code class="content__code_inline">Component&lt;P&gt;</code> пропсы которого, помимо типа представленного аргументом типа <code class="content__code_inline">WrappedProps</code>, должны принадлежать ещё и к типу <code class="content__code_inline">WrapperForWrappedProps</code> описывающего значения создаваемые и устанавливаемые компонентом-оберткой.</p>
<p>Стоит упомянуть, что тип<code class="content__code_inline">Component&lt;P&gt;</code> является типом объединением представляющим классовые и функциональные <em>React</em> компоненты.</p>
<p>Поскольку в нашем конкретном примере <em>функция hoc</em> в качестве компонента-обертки определяет функциональный компонент, тип возвращаемого значения указан соответствующим образом <code class="content__code_inline">FC&lt;T&gt;</code>. Пропсы компонента-обертки должны принадлежать к нескольким типам одновременно поскольку для его работы требуются не только пропсы необходимые исключительно ему (<code class="content__code_inline">WrapperProps</code>), но и пропсы которые он лишь пробрасывает оборачиваемому-компоненту (<code class="content__code_inline">WrappedProps</code>). Поэтому аргумент типа представляющего возвращаемое значение является типом пересечение <code class="content__code_inline">WrappedProps &amp; WrapperProps</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>                </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports maybe-class-name">ComponentType</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/**[2] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperForWrappedProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] Импортируем обобщенный тип Component&lt;P&gt; представляющий
</span><span class="token doc-comment" style="color:slategray"> * объединение классового и функционального React компонента.
</span><span class="token doc-comment" style="color:slategray"> * [1] WrapperProps описывает данные необходимые
</span><span class="token doc-comment" style="color:slategray"> * исключительно компоненту-обертке определяемому
</span><span class="token doc-comment" style="color:slategray"> * внутри функции hoc, который генерирует
</span><span class="token doc-comment" style="color:slategray"> * и устанавливает данные принадлежащие к типу 
</span><span class="token doc-comment" style="color:slategray"> * WrapperForWrappedProps [2] обертываемому-компоненту.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span>                </span><span class="token doc-comment" style="color:slategray">/**[3]      [4] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token generic-function" style="color:#DD4A68">withHoc</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">WrappedProps</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>
</span><span>        </span><span class="token doc-comment" style="color:slategray">/**[5]              [6]         [7]                 [8] */</span><span>
</span><span>    </span><span class="token maybe-class-name">WrappedComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ComponentType</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperForWrappedProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">)</span><span>
</span><span>       </span><span class="token doc-comment" style="color:slategray">/**[9]    [10]           [11] */</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [3] определение универсальной функции hoc
</span><span class="token doc-comment" style="color:slategray"> * чей единственный параметр типа WrappedProps [4]
</span><span class="token doc-comment" style="color:slategray"> * представляет часть пропсов обертываемого-компонента, а их оставшаяся часть, генерируемая
</span><span class="token doc-comment" style="color:slategray"> * компонентом-оберткой определенным в теле hoc, к типу WrapperForWrappedProps.
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * Единственный параметр hoc WrappedComponent [5] принадлежит
</span><span class="token doc-comment" style="color:slategray"> * к обобщенному типу Component&lt;P&gt; [6], которому в качестве аргумента типа установлен
</span><span class="token doc-comment" style="color:slategray"> * тип пересечение определяемый типами WrappedProps [7] и WrapperForWrappedProps [8].
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * Тип возвращаемого hoc значения обозначен как функциональный компонент [9] который по мимо пропсов
</span><span class="token doc-comment" style="color:slategray"> * устанавливаемых разработчиком и прокидываемых компонентом-оберткой WrappedProps [10] ожидает ещё и пропсы
</span><span class="token doc-comment" style="color:slategray"> * генерируемые и устанавливаемые компонентом-оберткой [11].
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * [!] принадлежность возвращаемого hoc значения к функциональному типу указана лишь по причине того
</span><span class="token doc-comment" style="color:slategray"> *, что в нашем пример hoc возвращает именно его, а не классовый компонент. 
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Поскольку пример является минималистическим реализация тела <em>hoc</em> будет включать в себя лишь определение компонента-обертки выступающего в качестве возвращаемого значение. Тип компонента-обертки принадлежит к функциональному компоненту пропсы которого должны соответствовать типам описывающих как пропсы необходимые исключительно самому компоненту-обертке, так и оборачиваемому-компоненту. В теле компонента-обертки происходит разделение полученных пропсов на две части. Одна предназначается исключительно самому компоненту-обертке и служит для определения значений предназначенных для объединения со второй частью. Объединенные значения устанавливаются в качестве пропсов оборачиваемому-компоненту ссылка на который доступна через единственный параметр функции <em>hoc</em>. Стоит обратить внимание, что поскольку вторая часть пропсов образуется как остаточные параметры полученные при деструктуризации, то их тип принадлежит к типу <code class="content__code_inline">Pick&lt;T, K&gt;</code>, который для совместимости с типом описывающим прокидываемые компонентом-оберткой пропсы необходимо сначала привести к типу <code class="content__code_inline">unknown</code>, а уже затем к конкретному типу <code class="content__code_inline">WrappedProps</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports maybe-class-name">ComponentType</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperForWrappedProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token generic-function" style="color:#DD4A68">withHoc</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">WrappedProps</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token maybe-class-name">WrappedComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ComponentType</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperForWrappedProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">)</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span>                    </span><span class="token doc-comment" style="color:slategray">/**[0]         [1]    [2]             [3] */</span><span>
</span><span>            </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">WrapperComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token" style="color:#905">FC</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> props </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                  </span><span class="token doc-comment" style="color:slategray">/**[4]            [5] */</span><span>
</span><span>                </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#999">,</span><span> </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedOnlyProps</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> props</span><span class="token" style="color:#999">;</span><span>
</span><span>                        </span><span class="token doc-comment" style="color:slategray">/**[6] */</span><span>
</span><span>                </span><span class="token" style="color:#07a">let</span><span> wrapperToWrappedProps </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                    c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">true</span><span>
</span><span>                </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>                       </span><span class="token doc-comment" style="color:slategray">/**[7]                      [8]                     [9]            [10]         [11] */</span><span>
</span><span>                </span><span class="token" style="color:#07a">let</span><span> wrappedFullProps </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrapperToWrappedProps</span><span class="token" style="color:#999">,</span><span> </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedOnlyProps </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#690">unknown</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">WrappedProps</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span>                            </span><span class="token doc-comment" style="color:slategray">/**[12]               [13] */</span><span>
</span><span>                </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedComponent</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedFullProps</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#999">}</span><span>
</span>
<span>                    </span><span class="token doc-comment" style="color:slategray">/**[14] */</span><span>
</span><span>            </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token maybe-class-name">WrapperComponent</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] определение компонента-обертки принадлежащего
</span><span class="token doc-comment" style="color:slategray"> * к типу функционального компонента [1] пропсы которого
</span><span class="token doc-comment" style="color:slategray"> * одновременно принадлежат к типам описывающих пропсы предназначаемые
</span><span class="token doc-comment" style="color:slategray"> * исключительно обертываемому-компоненту WrappedProps [2] и исключительно
</span><span class="token doc-comment" style="color:slategray"> * компоненту-обертке WrapperProps [3]. В теле компонента-обертки общие пропсы
</span><span class="token doc-comment" style="color:slategray"> * разделяются с помощью механизма деструктуризации на две категории, первая из
</span><span class="token doc-comment" style="color:slategray"> * которых предназначается самому компоненту-обертке [4], а вторая оборачиваемому-компоненту [5].
</span><span class="token doc-comment" style="color:slategray"> * Поскольку пропсы предназначенные оборачиваемому-компоненту [5] представляют из себя остаточные значения
</span><span class="token doc-comment" style="color:slategray"> * полученные при деструктуризации, они принадлежат к типу Pick&lt;T, K&gt;, что требует перед объединением их [9]
</span><span class="token doc-comment" style="color:slategray"> * с пропсами созданными компонентом-оберткой [8] сначала к типу unknown [10], а затем уже к необходимому 
</span><span class="token doc-comment" style="color:slategray"> * WrappedProps [11]. После этого слитые воедино пропсы можно устанавливать [13] компоненту [12] ссылка на который
</span><span class="token doc-comment" style="color:slategray"> * доступна в качестве единственного параметра hoc.
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * [14] возвращаем из hoc компонент-обертку.
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Теперь необходимо определить компонент, пропсы которого будут принадлежать к типам описывающих значения, чья установка разделена между разработчиком и компонентом-оберткой. Далее этот компонент необходимо передать в качестве аргумента созданному нами <em>hoc</em>, чьё возвращаемое значение является компонентом-оберткой, с которым и будет взаимодействовать разработчик. Осталось создать экземпляр компонента-обертки и убедится как сила типизации позволяет установить в качестве пропсов только необходимые значения.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">CustomComponentProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span>                </span><span class="token doc-comment" style="color:slategray">/**[1]                  [2]                     [3]                [4] [5][5] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">CustomComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperForWrappedProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>c</span><span class="token" style="color:#999">,</span><span> d</span><span class="token" style="color:#999">,</span><span> e</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span> 
</span>
<span>                    </span><span class="token doc-comment" style="color:slategray">/**[6]              [7]         [8] */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">CustomComponentWrapped</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">withHoc</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">CustomComponent</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] объявление типа CustomComponentProps представляющего пропсы предназначенные
</span><span class="token doc-comment" style="color:slategray"> * для обертываемого-компонента [1] и установка которых является
</span><span class="token doc-comment" style="color:slategray"> * задачей разработчика. Пропсы компонента-обертки представленного
</span><span class="token doc-comment" style="color:slategray"> * функциональным компонентом помимо типа CustomComponentProps [2]
</span><span class="token doc-comment" style="color:slategray"> * описывающего значения устанавливаемые разработчиком [5]
</span><span class="token doc-comment" style="color:slategray"> * также принадлежат к типу WrapperForWrappedProps [3] описывающего
</span><span class="token doc-comment" style="color:slategray"> * значения устанавливаемые компонентом-оберткой [4].
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * Ссылка на оборачиваемый-компонент передается в качестве аргумента [8]
</span><span class="token doc-comment" style="color:slategray"> * функции hoc [7], а результат вызова сохраняется в переменную представляющую
</span><span class="token doc-comment" style="color:slategray"> * компонент-обертку [8].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span>                     </span><span class="token doc-comment" style="color:slategray">/**[9]   [9]    [10]  [10] */</span><span>
</span><span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentWrapped</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">}</span><span> e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>                     </span><span class="token doc-comment" style="color:slategray">/**[9]   [9]    [11]     [10]  [10] */</span><span>
</span><span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentWrapped</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">}</span><span> d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">}</span><span> e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; Property &#x27;c&#x27; does not exist on type CustomComponentProps &amp; WrapperProps&#x27;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * При создании экземпляра компонента-обертки будет необходимо установить
</span><span class="token doc-comment" style="color:slategray"> * параметры описываемые как типом WrapperProps [9] и так и CustomComponentProps [10].
</span><span class="token doc-comment" style="color:slategray"> * При попытке установить иные значения возникнет ошибка. 
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Opredelenie_hoc_na_osnove_klassovogo_komponenta" class="content__section"><h2 class="content__heading">Определение hoc на основе классового компонента</h2>
<p>Поскольку пример для <em>hoc</em>, возвращающего в качестве компонента-обертки классовый компонент, отличается от предыдущего лишь заменой функции на класс и объявлением для него двух дополнительных типов <code class="content__code_inline">*State</code> и <code class="content__code_inline">*Snapshot</code>, в повторном комментировании происходящего попросту нет смысла.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports maybe-class-name">ComponentType</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">Component</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperState</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperSnapshot</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperForWrappedProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Поскольку компонент-обертка будет представлен
</span><span class="token doc-comment" style="color:slategray"> * классовым компонентом помимо описания его *Props
</span><span class="token doc-comment" style="color:slategray"> * также появляется необходимость в объявлении типов
</span><span class="token doc-comment" style="color:slategray"> * описывающих его *State [0] и *Snapshot [1].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [!] Стоит обратить внимание, что по причине
</span><span class="token doc-comment" style="color:slategray"> * упрощенности примера отсутствуют более компактные
</span><span class="token doc-comment" style="color:slategray"> * псевдонимы для менее компактных типов.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token generic-function" style="color:#DD4A68">withHoc</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">WrappedProps</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token maybe-class-name">WrappedComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ComponentType</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperForWrappedProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">)</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ComponentClass</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span>                    </span><span class="token doc-comment" style="color:slategray">/**[2] */</span><span>
</span><span>            </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperComponent</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Component</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name" style="color:#DD4A68">WrapperProps</span><span class="token" style="color:#DD4A68"> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#DD4A68"> </span><span class="token maybe-class-name" style="color:#DD4A68">WrappedProps</span><span class="token" style="color:#999">,</span><span class="token" style="color:#DD4A68"> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperState</span><span class="token" style="color:#999">,</span><span class="token" style="color:#DD4A68"> </span><span class="token maybe-class-name" style="color:#DD4A68">WrapperSnapshot</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                </span><span class="token" style="color:#DD4A68">render</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#999">,</span><span> </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedOnlyProps</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">props</span><span class="token" style="color:#999">;</span><span>
</span><span>                    </span><span class="token" style="color:#07a">let</span><span> wrapperToWrappedProps </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                        c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">true</span><span>
</span><span>                    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>                    </span><span class="token" style="color:#07a">let</span><span> wrappedFullProps </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrapperToWrappedProps</span><span class="token" style="color:#999">,</span><span> </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedOnlyProps </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#690">unknown</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">WrappedProps</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>                    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">WrappedComponent</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>wrappedFullProps</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>                </span><span class="token" style="color:#999">}</span><span>
</span><span>            </span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>            </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token maybe-class-name">WrapperComponent</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [2] определение компонента-обертки в виде классового компонента.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">CustomComponentProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">CustomComponent</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentProps</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> </span><span class="token maybe-class-name">WrapperForWrappedProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>c</span><span class="token" style="color:#999">,</span><span> d</span><span class="token" style="color:#999">,</span><span> e</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span> 
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">CustomComponentWrapped</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">withHoc</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">CustomComponent</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentWrapped</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">}</span><span> e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span></span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">CustomComponentWrapped</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> c</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">}</span><span> d</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">}</span><span> e</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; Property &#x27;c&#x27; does not exist on type CustomComponentProps &amp; WrapperProps&#x27;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><aside class="content-box__page__content-bar_post"><nav class="post-content-bar__nav"><a href="Kontekst_(Context)" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_prev"><div class="post-content-bar__nav__btn_padding-fix"><span role="img" aria-label="arrow-left" class="anticon anticon-arrow-left post-content-bar__nav__btn__icon_prev"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"></path></svg></span><span class="post-content-bar__nav__btn__label">Контекст (Context)</span></div></a><a href="Prostranstva_imen_(namespace)_i_moduli_(module)" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_next"><div class="post-content-bar__nav__btn_padding-fix"><span class="post-content-bar__nav__btn__label">Пространства имен (namespace) и модули (module)</span><span role="img" aria-label="arrow-right" class="anticon anticon-arrow-right post-content-bar__nav__btn__icon_next"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"></path></svg></span></div></a></nav></aside></main><div class="content-box__page-nav content-box__page-nav_right"><div class="page-nav__bar page-nav__bar_right"><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="up" class="anticon anticon-up"><svg viewBox="64 64 896 896" focusable="false" data-icon="up" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"></path></svg></span></button></span><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn page-nav__btn_next-page"><span role="img" aria-label="right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"></path></svg></span></button><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></span></button></span></div></div></div></div><div class="slide-layer__last-empty"></div></div><footer class="app-footer"><div class="app-footer__empty"></div><div class="app-footer_contacts app-footer__section"></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"urlResolver":{"image":"https://raw.githubusercontent.com/nauchikus/typescript-definitive-guide/master/book/ru/chapters/056.(React) HOC (Higher-Order Components)/images/"},"sectionInfoAll":[{"key":"HOC (Higher-Order Components)","elementId":"HOC_(Higher-Order_Components)","markdown":"# HOC (Higher-Order Components)\n\nНастало время рассмотреть со всех сторон механизм предназначенный для расширения функциональных возможностей компонента с помощью компонента-обертки обозначаемого как _Higher-Order Components_ или сокращенно _HOC_."},{"key":"HOC (Higher-Order Components)_0","elementId":"Opredelenie_hoc","markdown":"## Определение hoc\n\nРаньше, при разработке _React_ приложений разработчикам часто приходилось создавать конструкцию, известную в _react_ сообществе, как _HOC_ (_Higher-Order Components_).\n\n_HOC_ — это функция, которая на входе принимает один компонент, а на выходе возвращает новый с более расширенным функционалом. Другими словами, _hoc_ — это функция, ожидающая в качестве параметров компонент (назовем его входным), который оборачивается в другой, объявленный в теле функции, компонент, выступающий в роли возвращаемого из функции значения (назовем его выходным). Слово “оборачивание”, применимое относительно компонентов, означает, что один компонент отрисовывает (рендерит) другой компонент, со всеми вытекающими из этого процесса (проксирования). За счет того, что входной компонент оборачивается в выходной, достигается расширение его и/или общего функционала. Кроме того, это позволяет устанавливать входному компоненту как зависимости, так и данные, полученные из внешних сервисов."},{"key":"HOC (Higher-Order Components)_1","elementId":"Opredelenie_hoc_na_osnove_funkcionalnogo_komponenta","markdown":"## Определение hoc на основе функционального компонента\n\nВ качестве примера реализуем сценарий при котором пропсы _компонента обертки_ определяемого в теле _hoc_ разделяются на две категории. Первая необходима исключительно самому компоненту-обертке для генерации новых пропсов, которые в дальнейшем будут объединены с пропсами относящихся ко второй категории и установлены _оборачиваемому компоненту_. \n\nНачать стоит с детального рассмотрения сигнатуры универсальной функции, ожидающей в качестве единственного параметра типа тип `WrappedProps` представляющий пропсы предназначенные исключительно оборачиваемому-компоненту ссылка на который доступна через единственный параметр `WrappedComponent`. `WrappedComponent` может принадлежать, как к функциональному `FC\u003cT\u003e`, так и классовому типу `ComponentClass\u003cT\u003e`, поэтому указываем ему в аннотации обобщенный тип `Component\u003cP\u003e` пропсы которого, помимо типа представленного аргументом типа `WrappedProps`, должны принадлежать ещё и к типу `WrapperForWrappedProps` описывающего значения создаваемые и устанавливаемые компонентом-оберткой.\n\nСтоит упомянуть, что тип`Component\u003cP\u003e` является типом объединением представляющим классовые и функциональные _React_ компоненты.\n\nПоскольку в нашем конкретном примере _функция hoc_ в качестве компонента-обертки определяет функциональный компонент, тип возвращаемого значения указан соответствующим образом `FC\u003cT\u003e`. Пропсы компонента-обертки должны принадлежать к нескольким типам одновременно поскольку для его работы требуются не только пропсы необходимые исключительно ему (`WrapperProps`), но и пропсы которые он лишь пробрасывает оборачиваемому-компоненту (`WrappedProps`). Поэтому аргумент типа представляющего возвращаемое значение является типом пересечение `WrappedProps \u0026 WrapperProps`.\n\n\n`````ts\n                /**[0] */\nimport React, {ComponentType} from \"react\";\n\n\n/**[1] */\nexport interface WrapperProps {\n    a: number;\n    b: string;\n}\n/**[2] */\nexport interface WrapperForWrappedProps {\n    c: boolean;\n}\n\n/**\n * [0] Импортируем обобщенный тип Component\u003cP\u003e представляющий\n * объединение классового и функционального React компонента.\n * [1] WrapperProps описывает данные необходимые\n * исключительно компоненту-обертке определяемому\n * внутри функции hoc, который генерирует\n * и устанавливает данные принадлежащие к типу \n * WrapperForWrappedProps [2] обертываемому-компоненту.\n */\n\n\n                /**[3]      [4] */\nexport function withHoc\u003cWrappedProps\u003e(\n        /**[5]              [6]         [7]                 [8] */\n    WrappedComponent: ComponentType\u003cWrappedProps \u0026 WrapperForWrappedProps\u003e)\n       /**[9]    [10]           [11] */\n        : FC\u003cWrappedProps \u0026 WrapperProps\u003e\n\n/**\n * [3] определение универсальной функции hoc\n * чей единственный параметр типа WrappedProps [4]\n * представляет часть пропсов обертываемого-компонента, а их оставшаяся часть, генерируемая\n * компонентом-оберткой определенным в теле hoc, к типу WrapperForWrappedProps.\n * \n * Единственный параметр hoc WrappedComponent [5] принадлежит\n * к обобщенному типу Component\u003cP\u003e [6], которому в качестве аргумента типа установлен\n * тип пересечение определяемый типами WrappedProps [7] и WrapperForWrappedProps [8].\n * \n * Тип возвращаемого hoc значения обозначен как функциональный компонент [9] который по мимо пропсов\n * устанавливаемых разработчиком и прокидываемых компонентом-оберткой WrappedProps [10] ожидает ещё и пропсы\n * генерируемые и устанавливаемые компонентом-оберткой [11].\n * \n * [!] принадлежность возвращаемого hoc значения к функциональному типу указана лишь по причине того\n *, что в нашем пример hoc возвращает именно его, а не классовый компонент. \n */\n`````\n\nПоскольку пример является минималистическим реализация тела _hoc_ будет включать в себя лишь определение компонента-обертки выступающего в качестве возвращаемого значение. Тип компонента-обертки принадлежит к функциональному компоненту пропсы которого должны соответствовать типам описывающих как пропсы необходимые исключительно самому компоненту-обертке, так и оборачиваемому-компоненту. В теле компонента-обертки происходит разделение полученных пропсов на две части. Одна предназначается исключительно самому компоненту-обертке и служит для определения значений предназначенных для объединения со второй частью. Объединенные значения устанавливаются в качестве пропсов оборачиваемому-компоненту ссылка на который доступна через единственный параметр функции _hoc_. Стоит обратить внимание, что поскольку вторая часть пропсов образуется как остаточные параметры полученные при деструктуризации, то их тип принадлежит к типу `Pick\u003cT, K\u003e`, который для совместимости с типом описывающим прокидываемые компонентом-оберткой пропсы необходимо сначала привести к типу `unknown`, а уже затем к конкретному типу `WrappedProps`.\n\n\n`````ts\nimport React, {ComponentType} from \"react\";\n\n\nexport interface WrapperProps {\n    a: number;\n    b: string;\n}\nexport interface WrapperForWrappedProps {\n    c: boolean;\n}\n\nexport function withHoc\u003cWrappedProps\u003e(\n    WrappedComponent: ComponentType\u003cWrappedProps \u0026 WrapperForWrappedProps\u003e)\n        : FC\u003cWrappedProps \u0026 WrapperProps\u003e {\n\n                    /**[0]         [1]    [2]             [3] */\n            const WrapperComponent:FC\u003cWrappedProps \u0026 WrapperProps\u003e = props =\u003e {\n                  /**[4]            [5] */\n                let {a, b, ...wrappedOnlyProps} = props;\n                        /**[6] */\n                let wrapperToWrappedProps = {\n                    c: true\n                };\n                       /**[7]                      [8]                     [9]            [10]         [11] */\n                let wrappedFullProps = {...wrapperToWrappedProps, ...wrappedOnlyProps as unknown as WrappedProps};\n\n                            /**[12]               [13] */\n                return \u003cWrappedComponent {...wrappedFullProps} /\u003e\n            }\n\n                    /**[14] */\n            return WrapperComponent;\n}\n\n/**\n * [0] определение компонента-обертки принадлежащего\n * к типу функционального компонента [1] пропсы которого\n * одновременно принадлежат к типам описывающих пропсы предназначаемые\n * исключительно обертываемому-компоненту WrappedProps [2] и исключительно\n * компоненту-обертке WrapperProps [3]. В теле компонента-обертки общие пропсы\n * разделяются с помощью механизма деструктуризации на две категории, первая из\n * которых предназначается самому компоненту-обертке [4], а вторая оборачиваемому-компоненту [5].\n * Поскольку пропсы предназначенные оборачиваемому-компоненту [5] представляют из себя остаточные значения\n * полученные при деструктуризации, они принадлежат к типу Pick\u003cT, K\u003e, что требует перед объединением их [9]\n * с пропсами созданными компонентом-оберткой [8] сначала к типу unknown [10], а затем уже к необходимому \n * WrappedProps [11]. После этого слитые воедино пропсы можно устанавливать [13] компоненту [12] ссылка на который\n * доступна в качестве единственного параметра hoc.\n * \n * [14] возвращаем из hoc компонент-обертку.\n */\n`````\n\nТеперь необходимо определить компонент, пропсы которого будут принадлежать к типам описывающих значения, чья установка разделена между разработчиком и компонентом-оберткой. Далее этот компонент необходимо передать в качестве аргумента созданному нами _hoc_, чьё возвращаемое значение является компонентом-оберткой, с которым и будет взаимодействовать разработчик. Осталось создать экземпляр компонента-обертки и убедится как сила типизации позволяет установить в качестве пропсов только необходимые значения.\n\n`````ts\n/**[0] */\nexport interface CustomComponentProps {\n    d: number;\n    e: string;\n}\n\n                /**[1]                  [2]                     [3]                [4] [5][5] */\nexport const CustomComponent: FC\u003cCustomComponentProps \u0026 WrapperForWrappedProps\u003e = ({c, d, e}) =\u003e {\n    return null;\n} \n\n                    /**[6]              [7]         [8] */\nexport const CustomComponentWrapped = withHoc(CustomComponent);\n\n/**\n * [0] объявление типа CustomComponentProps представляющего пропсы предназначенные\n * для обертываемого-компонента [1] и установка которых является\n * задачей разработчика. Пропсы компонента-обертки представленного\n * функциональным компонентом помимо типа CustomComponentProps [2]\n * описывающего значения устанавливаемые разработчиком [5]\n * также принадлежат к типу WrapperForWrappedProps [3] описывающего\n * значения устанавливаемые компонентом-оберткой [4].\n * \n * Ссылка на оборачиваемый-компонент передается в качестве аргумента [8]\n * функции hoc [7], а результат вызова сохраняется в переменную представляющую\n * компонент-обертку [8].\n */\n\n\n                     /**[9]   [9]    [10]  [10] */\n\u003cCustomComponentWrapped a={0} b={``} d={1} e={``} /\u003e; // Ok\n                     /**[9]   [9]    [11]     [10]  [10] */\n\u003cCustomComponentWrapped a={0} b={``} c={true} d={1} e={``} /\u003e; // Error -\u003e Property 'c' does not exist on type CustomComponentProps \u0026 WrapperProps'\n\n/**\n * При создании экземпляра компонента-обертки будет необходимо установить\n * параметры описываемые как типом WrapperProps [9] и так и CustomComponentProps [10].\n * При попытке установить иные значения возникнет ошибка. \n */\n `````"},{"key":"HOC (Higher-Order Components)_2","elementId":"Opredelenie_hoc_na_osnove_klassovogo_komponenta","markdown":"## Определение hoc на основе классового компонента\n\nПоскольку пример для _hoc_, возвращающего в качестве компонента-обертки классовый компонент, отличается от предыдущего лишь заменой функции на класс и объявлением для него двух дополнительных типов `*State` и `*Snapshot`, в повторном комментировании происходящего попросту нет смысла.\n\n`````ts\nimport React, {ComponentType, Component} from \"react\";\n\n\nexport interface WrapperProps {\n    a: number;\n    b: string;\n}\n\n/**[0] */\ninterface WrapperState {}\n/**[1] */\ninterface WrapperSnapshot {}\n\nexport interface WrapperForWrappedProps {\n    c: boolean;\n}\n\n\n/**\n * Поскольку компонент-обертка будет представлен\n * классовым компонентом помимо описания его *Props\n * также появляется необходимость в объявлении типов\n * описывающих его *State [0] и *Snapshot [1].\n */\n\n/**\n * [!] Стоит обратить внимание, что по причине\n * упрощенности примера отсутствуют более компактные\n * псевдонимы для менее компактных типов.\n */\n\nexport function withHoc\u003cWrappedProps\u003e(\n    WrappedComponent: ComponentType\u003cWrappedProps \u0026 WrapperForWrappedProps\u003e)\n        : ComponentClass\u003cWrappedProps \u0026 WrapperProps\u003e {\n\n                    /**[2] */\n            class WrapperComponent extends Component\u003cWrapperProps \u0026 WrappedProps, WrapperState, WrapperSnapshot\u003e {\n                render() {\n                    let {a, b, ...wrappedOnlyProps} = this.props;\n                    let wrapperToWrappedProps = {\n                        c: true\n                    };\n                    let wrappedFullProps = {...wrapperToWrappedProps, ...wrappedOnlyProps as unknown as WrappedProps};\n\n\n                    return \u003cWrappedComponent {...wrappedFullProps} /\u003e\n                }\n            }\n\n\n            return WrapperComponent;\n}\n\n/**\n * [2] определение компонента-обертки в виде классового компонента.\n */\n\nexport interface CustomComponentProps {\n    d: number;\n    e: string;\n}\n\nexport const CustomComponent: FC\u003cCustomComponentProps \u0026 WrapperForWrappedProps\u003e = ({c, d, e}) =\u003e {\n    return null;\n} \n\nexport const CustomComponentWrapped = withHoc(CustomComponent);\n\n\n\u003cCustomComponentWrapped a={0} b={``} d={1} e={``} /\u003e; // Ok\n\u003cCustomComponentWrapped a={0} b={``} c={true} d={1} e={``} /\u003e; // Error -\u003e Property 'c' does not exist on type CustomComponentProps \u0026 WrapperProps'\n`````"}],"githubFileInfo":{"lastUpdate":1617711223000,"contributorAll":[{"name":"nauchikus","avatar":"https://avatars.githubusercontent.com/u/31518738?v=4","bio":"@TechnoFanatic(\"🍬\")\r\n","githubUrl":"https://github.com/nauchikus"}]},"pageNav":{"isPrevPage":true,"isNextPage":true,"prevPage":{"title":"Контекст (Context)","path":"Kontekst_(Context)"},"nextPage":{"title":"Пространства имен (namespace) и модули (module)","path":"Prostranstva_imen_(namespace)_i_moduli_(module)"}},"contentNavData":{"key":"HOC (Higher-Order Components)","level":0,"index":56,"contentIndex":0,"section":"React","title":"HOC (Higher-Order Components)","path":"HOC_(Higher-Order_Components)","elementId":"HOC_(Higher-Order_Components)","children":[{"key":"HOC (Higher-Order Components)_0","index":0,"contentIndex":1,"level":1,"section":"React","title":"Определение hoc","path":"Opredelenie_hoc","elementId":"Opredelenie_hoc"},{"key":"HOC (Higher-Order Components)_1","index":1,"contentIndex":2,"level":1,"section":"React","title":"Определение hoc на основе функционального компонента","path":"Opredelenie_hoc_na_osnove_funkcionalnogo_komponenta","elementId":"Opredelenie_hoc_na_osnove_funkcionalnogo_komponenta"},{"key":"HOC (Higher-Order Components)_2","index":2,"contentIndex":3,"level":1,"section":"React","title":"Определение hoc на основе классового компонента","path":"Opredelenie_hoc_na_osnove_klassovogo_komponenta","elementId":"Opredelenie_hoc_na_osnove_klassovogo_komponenta"}]}},"__N_SSG":true},"page":"/book/chapters/[chapterId]","query":{"chapterId":"HOC_(Higher-Order_Components)"},"buildId":"1XVAPM7hhG7WH3KTrWExV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>